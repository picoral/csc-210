<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CSC 210 Fall 2024 - Programming Assigmment 05</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CSC 210 Fall 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./programming-assignments.html"> 
<span class="menu-text">Programming Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./modules.html"> 
<span class="menu-text">Modules</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pa5-hashmapimpl-key" id="toc-pa5-hashmapimpl-key" class="nav-link active" data-scroll-target="#pa5-hashmapimpl-key">PA5-HashMapImpl-Key</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#the-assignment" id="toc-the-assignment" class="nav-link" data-scroll-target="#the-assignment">The Assignment</a></li>
  <li><a href="#junit-implementation" id="toc-junit-implementation" class="nav-link" data-scroll-target="#junit-implementation">JUnit implementation</a></li>
  <li><a href="#hash-map-implementation" id="toc-hash-map-implementation" class="nav-link" data-scroll-target="#hash-map-implementation">Hash Map Implementation</a>
  <ul class="collapse">
  <li><a href="#hash-map-background" id="toc-hash-map-background" class="nav-link" data-scroll-target="#hash-map-background">Hash Map Background</a></li>
  <li><a href="#a-generic-myhashmap-class" id="toc-a-generic-myhashmap-class" class="nav-link" data-scroll-target="#a-generic-myhashmap-class">A Generic MyHashMap class</a></li>
  <li><a href="#the-hash-function" id="toc-the-hash-function" class="nav-link" data-scroll-target="#the-hash-function">The Hash Function</a></li>
  <li><a href="#handling-collisions" id="toc-handling-collisions" class="nav-link" data-scroll-target="#handling-collisions">Handling collisions</a></li>
  </ul></li>
  <li><a href="#error-checking" id="toc-error-checking" class="nav-link" data-scroll-target="#error-checking">Error checking</a></li>
  <li><a href="#the-debug-command" id="toc-the-debug-command" class="nav-link" data-scroll-target="#the-debug-command">The DEBUG command</a></li>
  <li><a href="#extra-credit" id="toc-extra-credit" class="nav-link" data-scroll-target="#extra-credit"><strong>EXTRA CREDIT</strong></a></li>
  <li><a href="#grading-criteria" id="toc-grading-criteria" class="nav-link" data-scroll-target="#grading-criteria">Grading Criteria</a></li>
  <li><a href="#submission" id="toc-submission" class="nav-link" data-scroll-target="#submission">Submission</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Programming Assigmment 05</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Deadline: October 09, 2024 – Wednesday, 11:30pm</p>
<section id="pa5-hashmapimpl-key" class="level1">
<h1>PA5-HashMapImpl-Key</h1>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>The goal of this assignment is to use two or more data structures in a coordinated way to solve a problem.</p>
<p>The problem to be solved in this assignment is to implement a HashMap. Therefore, an additional learning objective is to increase your skill level with HashMaps from just being able to use them to understanding how to implement them.</p>
<p>The dictionary abstract data type can be used to solve many programming problems and therefore questions about hash tables frequently occur in job interviews.</p>
</section>
<section id="the-assignment" class="level2">
<h2 class="anchored" data-anchor-id="the-assignment">The Assignment</h2>
<p>You will be redoing PA2-HashMap with your own HashMap implementation called MyHashMap. Here are the key components of this assignment:</p>
<ul>
<li><p>PA5Test.java with JUnit tests of all the functionality MyHashMap needs to provide to implement PA2. The tests can be written for HashMap and then edited slightly to be used to test MyHashMap instead. Implementing them first will help the development of MyHashMap be more test driven.</p></li>
<li><p>MyHashMap.java with an implementation of a generic, MyHashMap class. Your hashmap should only have 10 buckets.</p></li>
<li><p>PA5Main.java with an edited version of PA2Main.java that…</p>
<ul>
<li><p>uses MyHashMap instead of the HashMap provided in java.util</p></li>
<li><p>provides a DEBUG command that outputs the printTable() information about conflicts in a table that maps flight codes to integers</p></li>
<li><p>has been improved based on PA2 code clarity and decomposition feedback and follows the more stringent grading criteria specified below</p></li>
<li><p>does some error checking on the input file and skips bad lines</p></li>
</ul></li>
</ul>
</section>
<section id="junit-implementation" class="level2">
<h2 class="anchored" data-anchor-id="junit-implementation">JUnit implementation</h2>
<p>The PA5Test.java file should contain unit tests for all of the HashMap functionality your PA2 program uses. We strongly recommend you write the tests for HashMap first. They should all pass. Then replace HashMap with MyHashMap and you can test MyHashMap as you implement it.</p>
<p>For grading, we will look for unit test cases for at least the following: * put * get * containsKey * keySet</p>
</section>
<section id="hash-map-implementation" class="level2">
<h2 class="anchored" data-anchor-id="hash-map-implementation">Hash Map Implementation</h2>
<p>A hash table is a data structure that offers quick O(1) operations such as inserting data and searching for data. You have used a form of a hash table when using the HashMap class in Java. However, in this assignment you will implement your own version of a hash map.</p>
<section id="hash-map-background" class="level3">
<h3 class="anchored" data-anchor-id="hash-map-background">Hash Map Background</h3>
<p>First, you should read up on what a hash table is. <a href="https://en.wikipedia.org/wiki/Hash_table">Wikipedia</a> is a good place to start.</p>
<p>At its heart a hash table (hash map) is an array that works together with a function, known as a hash function, that takes a key and returns an index into that array. We usually call the elements in the array buckets. This is because when more than one element maps to the same array location (or bucket), there needs to be some organization for keeping all those elements there and being able to find them.</p>
<p>A critical part of writing a good hash map implementation is writing a good (and appropriate) hash function. It should spread out values evenly based on different input values and needs to always produce the same value if the same element is given to it.</p>
<p>In general, there are multiple ways to implement a hash map. Here are three: * An array that contains a linked list for each bucket * A linked list that contains a linked list for each bucket (2d linked list) * An array that contains an array for each bucket (a 2d array)</p>
<p>However, since you are implementing a generic hash table in Java and generics are problematic in arrays (https://docs.oracle.com/javase/tutorial/java/generics/restrictions.html), we strongly recommend you use an ArrayList of linked lists. Those linked lists can be LinkedLists, ArrayLists, or your own linked list implementation where the key,value pairs link to each other.</p>
<p>Your hash table implementation should be called MyHashMap.</p>
</section>
<section id="a-generic-myhashmap-class" class="level3">
<h3 class="anchored" data-anchor-id="a-generic-myhashmap-class">A Generic MyHashMap class</h3>
<p>You will create a class called MyHashMap that maps keys to values. To enable the construction and use of MyHashMap for any provided key and value types, you will implement it as a generic class.</p>
<p>This is done by declaring MyHashMap with type parameters.</p>
<pre><code>    class MyHashMap&lt;K,V&gt; {
        ...
    } </code></pre>
<p>Throughout the rest of the class definition, the capital letter ‘K’ will be used to declare variables of the key type, and the capital letter ‘V’ will be used to declare variables of the value type.</p>
<p>See https://docs.oracle.com/javase/tutorial/java/generics/types.html for more information.</p>
</section>
<section id="the-hash-function" class="level3">
<h3 class="anchored" data-anchor-id="the-hash-function">The Hash Function</h3>
<p>For this assignment, you will be implementing your own HashMap class using the following hash function.</p>
<ol type="1">
<li>Find the hash code of that object (look into the hashCode method)</li>
<li>Mod it by the number of buckets<br>
</li>
<li>Then take its absolute value.</li>
</ol>
<p>Here is the code for the hash function. You can use this code directly in your implementation:</p>
<pre><code>    private int hash(K key) {
        int hashCode = key.hashCode();
        int index = hashCode % numBuckets;
        return Math.abs(index);
    }</code></pre>
</section>
<section id="handling-collisions" class="level3">
<h3 class="anchored" data-anchor-id="handling-collisions">Handling collisions</h3>
<p>This hash map will use chaining to handle the collisions of elements. Your hash map should only have 10 buckets! Collisions will happen. We will be covering this in class.</p>
</section>
</section>
<section id="error-checking" class="level2">
<h2 class="anchored" data-anchor-id="error-checking">Error checking</h2>
<p>You <strong>WILL</strong> need to error check. This involves checking to see if a line in the input file is valid. If it is not a valid line, skip it. You know a line is invalid if there is no comma in it. (hint hint)</p>
</section>
<section id="the-debug-command" class="level2">
<h2 class="anchored" data-anchor-id="the-debug-command">The DEBUG command</h2>
<p>The program should be able to accept the DEBUG command on the command line after the input file name. That output should show how all of the airport codes in the input file map into indices in the hash table.</p>
<p>The DEBUG command should cause the creation of a MyHashMap with the keys being all of the airport codes in the input file. The goal is to see how many hash conflicts occur. After filing the MyHashMap, the program should call the printTable() method on MyHashMap. The printTable() method should output how many conflicts occur at each bucket and list the keys in that bucket.</p>
<p>Here is an example input file:</p>
<pre><code>airline,airline ID, source airport, source airport id, destination apirport, destination airport id, codeshare, stops, equipment
3S,11741,PTP,2881,FDF,2878,,0,AT5 320
3S,11741,PTP,2881,SBH,6460,,0,DHT
3S,11741,PTP,2881,SDQ,1762,,0,AT5
3S,11741,PTP,2881,SFG,2879,,0,AT5
3S,11741,PTP,2881,SXM,2899,,0,AT5
3S,11741,SBH,6460,PTP,2881,,0,DHT
3S,11741,SDQ,1762,PTP,2881,,0,AT5
3S,11741,SDQ,1762,SXM,2899,,0,AT5
3S,11741,SFG,2879,PTP,2881,,0,AT5
3S,11741,SLU,2893,FDF,2878,,0,AT5
3S,11741,SXM,2899,DOM,2877,,0,AT5
3S,11741,SXM,2899,PTP,2881,,0,AT5
3S,11741,SXM,2899,SDQ,1762,,0,AT5
3U,4608,BHY,6351,XIY,3379,,0,321
3U,4608,CAN,3370,CKG,3393,,0,321 320
3U,4608,CAN,3370,CTU,3395,,0,321 320 330
3U,4608,CAN,3370,SPN,2244,,0,330
3U,4608,CGO,3375,CGQ,4380,,0,321
3U,4608,CGO,3375,CKG,3393,,0,321</code></pre>
<p>Here is the output of the program when given this input file and the DEBUG command.</p>
<pre><code>Index 0: (1 conflicts), [CAN XIY ]
Index 1: (1 conflicts), [SPN SBH ]
Index 2: (0 conflicts), [SDQ ]
Index 3: (0 conflicts), [CKG ]
Index 4: (3 conflicts), [DOM SLU SFG PTP ]
Index 5: (0 conflicts), []
Index 6: (0 conflicts), [CTU ]
Index 7: (1 conflicts), [CGO BHY ]
Index 8: (1 conflicts), [SXM FDF ]
Index 9: (0 conflicts), [CGQ ]
Total # of conflicts: 7</code></pre>
</section>
<section id="extra-credit" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit"><strong>EXTRA CREDIT</strong></h2>
<p>If you provide a better hash function than the one listed above, meaning that you have fewer collisions (and/or a better distribution) on the full flight database than the provided hash function, you will be able to receive 5 points of extra credit on PA5. Provide your README.md file with example DEBUG output to show that your hash function is better. Also explain why your hash function is better.</p>
</section>
<section id="grading-criteria" class="level2">
<h2 class="anchored" data-anchor-id="grading-criteria">Grading Criteria</h2>
<p>Half of the PA5 grade will be correctness. For this assignment, there will be some private test cases on Gradescope used for grading.</p>
<p>The other half of the PA5 grade will be your decomposition and code clarity and the JUnit tests.</p>
<p>Decomposition * Should carefully select data structures that implement the required MyHashMap functionality. You cannot use the provided Java HashMap implementation or HashSet implementation or any other Map or hash table implementation written by someone else.</p>
<ul>
<li><p>Points will be taken off for copy, pasted, and edited code that should have been encapsulated in a method.</p></li>
<li><p>This program will use two or more source files in addition to the source file for the JUnit tests. Each of these files should be (&lt;200 lines).</p></li>
<li><p>Each static method should be less than 30 lines. This INCLUDES comments, but not the method header. It is easier to read a function if it can all fit on one screen.</p></li>
<li><p>Make things as simple as possible.</p>
<ul>
<li>Only use one Scanner instance.</li>
<li>Don’t use lambda functions or other features in non-standard ways.</li>
<li>Avoid nested loops.</li>
<li>Avoid nesting conditionals.</li>
<li>Avoid chaining: see the Piazza post for more info</li>
</ul></li>
</ul>
<p>Code Clarity * YOU should be able to read, understand, and explain your own code to someone else a couple days after you wrote it. * No magic numbers * No methods written to just get the test cases to work</p>
<ul>
<li><p>There needs to be a balance between no comments in the body of the methods and a comment for every line in the program. Either extreme will result in points off.</p></li>
<li><p>The file header should include instructions on how someone would use this program. To use the program, one would need to know the input file format.</p></li>
<li><p>Use meaningful variable names. Loop iterators can be simple (i for integers, s for strings, n for numbers, etc.).</p></li>
<li><p>The clearest code examples will be anonymously shown in class.</p></li>
<li><p>The most obfuscated code examples will be anonymously shown in class with suggestions for improvement.</p></li>
</ul>
<p>The coding style in terms of spacing, etc. should be done automatically every time you save in Eclipse. As long as you stick with those defaults, the syntax style should be fine.</p>
</section>
<section id="submission" class="level2">
<h2 class="anchored" data-anchor-id="submission">Submission</h2>
<p>Write your own code. We will be using a tool that finds overly similar code. This Spring 2018 semester in CS 210 we unfortunately have had academic integrity cases. I recommend that when talking with others about the assignment, do not write anything down.</p>
<p>For PA5, you are <strong>REQUIRED</strong> to submit all of your java source files to Gradescope.</p>
<p>There is NO Aropa submission for PA5.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>