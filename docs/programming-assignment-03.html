<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CSC 210 Fall 2024 - Programming Assignment 03</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">CSC 210 Fall 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./programming-assignments.html"> 
<span class="menu-text">Programming Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./modules.html"> 
<span class="menu-text">Modules</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pa3-exhaustingpastries-key" id="toc-pa3-exhaustingpastries-key" class="nav-link active" data-scroll-target="#pa3-exhaustingpastries-key">PA3-ExhaustingPastries-Key</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#the-assignment" id="toc-the-assignment" class="nav-link" data-scroll-target="#the-assignment">The Assignment</a></li>
  <li><a href="#input-file" id="toc-input-file" class="nav-link" data-scroll-target="#input-file">Input File</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a>
  <ul class="collapse">
  <li><a href="#baker-perspective" id="toc-baker-perspective" class="nav-link" data-scroll-target="#baker-perspective">Baker perspective</a></li>
  <li><a href="#customer-perspective" id="toc-customer-perspective" class="nav-link" data-scroll-target="#customer-perspective">Customer perspective</a></li>
  <li><a href="#other-points-to-consider" id="toc-other-points-to-consider" class="nav-link" data-scroll-target="#other-points-to-consider">Other points to consider</a></li>
  </ul></li>
  <li><a href="#error-checking" id="toc-error-checking" class="nav-link" data-scroll-target="#error-checking">Error Checking</a></li>
  <li><a href="#more-examples" id="toc-more-examples" class="nav-link" data-scroll-target="#more-examples">More Examples</a>
  <ul class="collapse">
  <li><a href="#an-example-with-an-error" id="toc-an-example-with-an-error" class="nav-link" data-scroll-target="#an-example-with-an-error">An Example with an Error</a></li>
  <li><a href="#another-error-example" id="toc-another-error-example" class="nav-link" data-scroll-target="#another-error-example">Another Error Example</a></li>
  </ul></li>
  <li><a href="#testing-your-program" id="toc-testing-your-program" class="nav-link" data-scroll-target="#testing-your-program">Testing your program</a></li>
  <li><a href="#decomposition-ideas" id="toc-decomposition-ideas" class="nav-link" data-scroll-target="#decomposition-ideas">Decomposition Ideas</a></li>
  <li><a href="#grading-criteria" id="toc-grading-criteria" class="nav-link" data-scroll-target="#grading-criteria">Grading Criteria</a></li>
  <li><a href="#submission" id="toc-submission" class="nav-link" data-scroll-target="#submission">Submission</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Programming Assignment 03</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Deadline: September 20, 2024 – Wednesday, 11:30pm</p>
<section id="pa3-exhaustingpastries-key" class="level1">
<h1>PA3-ExhaustingPastries-Key</h1>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p>The goal of this assignment is to practice the following decomposition, algorithm pattern, and data structure approaches.</p>
<ul>
<li><p>Algorithmic pattern: exhaustive search</p></li>
<li><p>Decomposition approach: separating out iteration over all possibilities from the evaluation of each possibility</p></li>
<li><p>Data structure: arrays and collections</p></li>
</ul>
<p>The assignment will also require checking that the input data is valid.</p>
</section>
<section id="the-assignment" class="level2">
<h2 class="anchored" data-anchor-id="the-assignment">The Assignment</h2>
<p>For this assignment, you are simulating a bakery. You will be given an input file which lists every pastry the bakery is selling today. The pastries can be cut into slices which are sold for different amounts depending on their length. Your goal is to maximize the bakery’s profits by finding which combination of slices will maximize your profits. Once you have sliced the pastries and set their prices, you will take the role of the customer. Given a certain budget, you will find the maximum number of unique pastries the customer can purchase. The customer will be buying all of any one pastry.</p>
</section>
<section id="input-file" class="level2">
<h2 class="anchored" data-anchor-id="input-file">Input File</h2>
<p>The program should have the following usage:</p>
<pre><code>java PA3Main inputFile</code></pre>
<p>The input file should have the following format:</p>
<pre><code>&lt;customer budget integer&gt;
&lt;string&gt;: &lt;integer cost of 1in slice&gt; &lt;integer cost of 2in slice&gt; &lt;integer cost of 3in slice&gt; ...
&lt;string&gt;: &lt;integer cost of 1in slice&gt; &lt;integer cost of 2in slice&gt; &lt;integer cost of 3in slice&gt; ...
...
...
...</code></pre>
<p>The first integer is the budget customers have for buying pastries. This is followed by a list of pastries, starting with a pastry name, then followed by the price for length of 1 unit, price per length of 2 units, etc. The file could have any number of lines and each pastry line could have any number of length costs. If a pastry has X costs after it, then it is X inches long.</p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>As an example, consider the PublicTestCases/simple.in file:</p>
<pre><code>5
baguette: 2 3 3 4
donut: 1 2 3 4
baumkuchen: 1 2 3 4 </code></pre>
<p>The customer has a $5 budget. The pastry shop has a baguette that is 4 inches long with one-inch pieces costing $2 each, two-inch pieces costing $3 each, three-inch pieces costing $3 each, and a four-inch piece is $4 each. The baker also has a donut and a baumkuchen that can be broken into 1in pieces for $1 each, 2inch pieces for $2 each, etc.</p>
<p>For the baker, the idea is to enumerate over all possible ways to cut up the pastry and determine which cutting costs the most and thus makes the most for the baker. For the customer, the idea is to buy as many full pastries as possible.</p>
<section id="baker-perspective" class="level3">
<h3 class="anchored" data-anchor-id="baker-perspective">Baker perspective</h3>
<p>Below is an enumeration of all possible ways to cut the baguette based on the number of pieces of each size. The last column is how much money such a cutting will make. The enumeration is not showing combinations that are not physically possible. For example, a 4in baguette cannot be broken into 5 1in pieces. The baker will want to pick the highest one.</p>
<pre><code> #1in #2in #3in #4in  $$
   0   0    0    0    0
   1   0    0    0    2
   2   0    0    0    4
   3   0    0    0    6
   4   0    0    0    8
   1   1    0    0    5
   2   1    0    0    7
   1   0    1    0    5
   ...</code></pre>
<p>A similar enumeration should be done for the donut and the baumkuchen.</p>
</section>
<section id="customer-perspective" class="level3">
<h3 class="anchored" data-anchor-id="customer-perspective">Customer perspective</h3>
<p>Then the customer will buy the maximum number of unique pastries they can with their budget. For this example the customer would do the following enumeration over combinations that cost less than the budget:</p>
<pre><code>baguette donut baumkuchen  cost   #unique
   0       0        0        0       0
   0       4        0        4       1
   0       0        4        4       1</code></pre>
<p>Hint: the customer should buy pastries from cheapest to more expensive.</p>
<p>Here we have a tie. For ties the customer will buy the item that comes first alphabetically. Thus for this example the customer would choose the baumkuchen.</p>
<p>Here is what the final output would be for this example:</p>
<pre><code>baguette costs $8
baumkuchen costs $4
donut costs $4

Can buy baumkuchen for $4

The max number of unique pastries that can be bought with $5 is: 1</code></pre>
<p>For this simple example, the budget of $5 is enough to buy the $4 configuration of the baumkuchen. It could buy the donut instead, but since either could be bought, the on that comes alphabetically first is selected instead.</p>
</section>
<section id="other-points-to-consider" class="level3">
<h3 class="anchored" data-anchor-id="other-points-to-consider">Other points to consider</h3>
<ul>
<li><p>The lines containing the pastry costs are listed in alphabetical order by the name of each pastry.</p></li>
<li><p>The lines which show each unique pastry that can be bought are listed in ascending order by price, and within each price listed alphabetically.</p></li>
<li><p>You can assume the prices are separated by a single space. We are not going to have any tricky inputs with delimiters other than a single space.</p></li>
<li><p>Any pastry with no prices given will considered length 0 for price 0.</p></li>
<li><p>When a customer buys a pastry, they buy all pieces of the pastry. The bakery only has the one pastry of each kind that it cut into pieces. This is a simplification to make the problem a bit easier.</p></li>
</ul>
</section>
</section>
<section id="error-checking" class="level2">
<h2 class="anchored" data-anchor-id="error-checking">Error Checking</h2>
<p>For this assignment, you will be responsible for developing checks on the input data.</p>
<p>Required error checking:</p>
<pre><code>If an invalid file is given then print the following and exit the program:
'ERROR: File not found' and exit with a status code of 1

If budget is not a number print the following and exit the program:
'ERROR: Incorrect budget input' and exit with a status code of 1

If any price per length is not a number print the following, 
ignore that pastry, but continue processing:
'ERROR: Incorrect price input' and continue reading the other pastries</code></pre>
<p>Any pastry with no prices given will considered length 0 for price 0. This is NOT an error.</p>
</section>
<section id="more-examples" class="level2">
<h2 class="anchored" data-anchor-id="more-examples">More Examples</h2>
<section id="an-example-with-an-error" class="level3">
<h3 class="anchored" data-anchor-id="an-example-with-an-error">An Example with an Error</h3>
<p>Given the following input file:</p>
<pre><code>300
Cheese Cake: 62 83 44 48 
Chocolate Cake: 97 100 11 49 z 96 28 33 45 
Baguette: 24 24 58 79 12 83 79 44 13 5 
Blank Pastry: </code></pre>
<p>The output should be:</p>
<pre><code>ERROR: Incorrect price input
Baguette costs $240
Blank Pastry costs $0
Cheese Cake costs $248

Can buy Blank Pastry for $0
Can buy Baguette for $240

The max number of unique pastries that can be bought with $300 is: 2</code></pre>
<p>Notice the one error print out due to the ‘Chocolate Cake’ pastry has a ‘z’ in it. Thus it is ignored, but processing continues.</p>
<p>Also notice that the lines containing the pastry costs are listed in alphabetical order by the name of each pastry. The lines which show each unique pastry that can be bought are listed in ascending order by price, and within each price listed alphabetically.</p>
</section>
<section id="another-error-example" class="level3">
<h3 class="anchored" data-anchor-id="another-error-example">Another Error Example</h3>
<p>Given the following input file:</p>
<pre><code>IncorrectBudget
Cheese Cake: 62 83 44 48 
Chocolate Cake: 97 100 11 49 96 28 33 45 
Baguette: 24 24 58 79 12 83 79 44 13 5 
Blank Pastry: </code></pre>
<p>The output should be:</p>
<pre><code>ERROR: Incorrect budget input
</code></pre>
</section>
</section>
<section id="testing-your-program" class="level2">
<h2 class="anchored" data-anchor-id="testing-your-program">Testing your program</h2>
<p>When you commit and push, Travis CI will send you an email to let you know if the public test cases failed. We STRONGLY recommend you put some of your own test cases in PublicTestCases/. Read grade.py to see how the .in and .out files should be named. Also look at the examples that are already in the PublicTestCases/ subdirectory.</p>
<p>Upload it to Gradescope and you will be able to see which public test cases were passed/failed.</p>
</section>
<section id="decomposition-ideas" class="level2">
<h2 class="anchored" data-anchor-id="decomposition-ideas">Decomposition Ideas</h2>
<p>See the slides from class and examples from Section 2 about performing exhaustive searches. What will the stopping criteria be for the TWO exhaustive searches this program will need to do?</p>
</section>
<section id="grading-criteria" class="level2">
<h2 class="anchored" data-anchor-id="grading-criteria">Grading Criteria</h2>
<p>Half of the PA3 grade will be correctness. For this assignment, there will be some private test cases. Partial points will be given if just one or two of the commands is implemented and works on those test cases.</p>
<p>The other half of the PA3 grade will be your decomposition and code clarity.</p>
<p>Decomposition * Should carefully select data structures that implement the required functionality. For example, if you avoid using HashMaps, it will probably result in more complicated code and thus points off.</p>
<ul>
<li><p>Should just use static methods in the single PA3Main class.</p></li>
<li><p>Use a single file. This should be a small program (&lt;300 lines).</p></li>
<li><p>Each static method should be less than 30 lines. This INCLUDES comments. It is easier to read a function if it can all fit on one screen.</p></li>
<li><p>Make things as simple as possible.</p>
<ul>
<li>Avoid nested loops.</li>
<li>Avoid nesting conditionals.</li>
<li>Avoid chaining, i.e., too many levels of user-defined methods calling other user-defined methods. Putting most of the functionality in another static method that returns void that main calls is an example of this.</li>
</ul></li>
</ul>
<p>Code Clarity * YOU should be able to read, understand, and explain your own code to someone else a couple days after you wrote it.</p>
<ul>
<li><p>There needs to be a balance between no comments and a comment for every line in the program. Either extreme will result in points off.</p></li>
<li><p>The file header should include instructions on how someone would use this program. To use the program, one would need to know the input file format.</p></li>
<li><p>Use meaningful variable names. Loop iterators can be simple (i for integers, s for strings, n for numbers, etc.).</p></li>
<li><p>The clearest code examples will be anonymously shown in class.</p></li>
<li><p>The most obfuscated code examples will be anonymously shown in class with suggestions for improvement.</p></li>
</ul>
<p>The coding style in terms of spacing, etc. should be done automatically every time you save in Eclipse. As long as you stick with those defaults, the syntax style should be fine.</p>
<p>Write your own code. We will be using a tool that finds overly similar code. I recommend that when talking with others about the assignment, do not write anything down.</p>
</section>
<section id="submission" class="level2">
<h2 class="anchored" data-anchor-id="submission">Submission</h2>
<p>For PA3, you are required to submit your PA3Main.java file to Gradescope.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>